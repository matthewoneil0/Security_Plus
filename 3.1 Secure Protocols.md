# Given a scenario, implement secure protocols

## Secure Protocols
 **Voice and video**
 - **SRTP** - Secure Real-Time Transport Protocol / Secure RTP
 - This adds security features to keep convos private
 - Encryption through AES 
 - Offers authentication, integrity, and replay protection through HMAC-SHA1 hashed based mesage authentication code (using SHA1)

**Time synchronization**
- OG NTP (Network time protocol)  doesn't have any security features
- Use NTPSec! - Secure Network Time Protocol

**Email**
- **S/MIME** - Secure/Multipurpose Internet Mail Extensions
	- Public key encryption and digital signing. Requires a PKI or similar org of keys
- **Secure POP and Secure IMAP**
	- Use a STARTTLS extension to encrypt POP3 w/ SSL or use IMAP w/ SSl
- **SSL/TLS**
	- If the mail is browser based, always encrypt with TLS/SSl

**Web**
- **SSL/TLS** - Secure Socket Layer/Transport Layer Security
- **HTTPS** - Hypertext Transfer Protocol Secure/SSL(TLS)
- These you public key encryption where the private key is on the server
	- Symmetric session key is transferred using asymmetric encryption
	- Provides security and speed

**IPsec (Internet Protocol Security)**
- Security at OSI Layer 3 (network layer)
- Provides confidentiality and integrity/anti-replay
- This is very standardized
- 2 core protocols - Authentication Header (AH) & Encapsulation Security Payload (ESP)

**File transfer**
- **FTPS** - FTP over SSL
- **SFTP** - SSH File Transfer Protocol
	- Provides additional management functionality

**LDAP (Lightweight Directory Access Protocol)**
- For reading and writing directories over an IP network
- Specs written by Telecommunications Union (TU)
- e.g. Active Directory, OpenLDAP, Apple OpenDirectory, etc.
- **LDAPS (LDAP Secure/SSL)** - LDAP over SSL
- **SASL (Simple Authentication & Security Layer)** - Provides authenication using many different methods, i.e. Kerberos or client certificatate

**Remote Access** 
- **SSH** - Secure Shell - replaces Telnet with encryption - allows remote shell access

**Domain name resolution**
- **DNS** had no security in the OG design
- **DNSSEC** - Domain Name System Security Extensions
	- Provide authentication, data integrity, and validation
	- We use public key cryptography 
		- DNS records are signed with a trusted 3rd party
		- Signed DNS records are published in DNS

**Routing and switching**
- Use SSH
- **SNMPv3 (Simple Network Management Protocol version 3)** - used to query routers and switches for information.
	- Provides confidentiality, integrity, and authentication
- **HTTPS** - Browser-based management

**Network address allocation**
- **DHCP** does not come with security
- **Rogue DHCP servers** - In AD, DHCP servers have to be authorized
- Some switches can be configured to only trust specific DHCP servers
- **DHCP client DoS** - Starvation attack
	- Uses spoofed MAC addresses to exhaust the DHCP pool

**Subscription services**
- Automated subscriptions
	- Anti-virus, IPS updates, Firewall and signatures updates
	- Constant updates are a must
	- Check for encryption and integrity